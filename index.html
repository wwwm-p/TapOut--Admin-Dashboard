<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>School Admin Dashboard</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; font-family: Arial, sans-serif; }
    body { background: #f4f5f7; color: #333; }
    .top-bar { display:flex; justify-content: space-between; align-items:center; background:#fff; padding: 12px 24px; border-bottom:1px solid #ddd; position: sticky; top:0; z-index:100; }
    .top-bar .school-name { font-weight:bold; font-size:1.2em; }
    .top-bar .top-actions { display:flex; gap:16px; align-items:center; }
    .top-bar .badge { background:red; color:white; border-radius:12px; padding:4px 8px; font-size:0.8em; }
    .container { display:flex; min-height:100vh; }
    .sidebar { width:220px; background:#2c3e50; color:white; display:flex; flex-direction:column; }
    .sidebar a { padding:16px 20px; text-decoration:none; color:white; display:flex; align-items:center; gap:8px; }
    .sidebar a:hover, .sidebar a.active { background:#34495e; cursor:pointer; }
    .main { flex:1; padding:24px; }
    .section { margin-bottom:24px; background:#fff; padding:16px; border-radius:8px; box-shadow:0 1px 3px rgba(0,0,0,0.1); }
    .card-container { display:flex; flex-wrap:wrap; gap:16px; }
    .card { background:#fff; padding:16px; border-radius:8px; box-shadow:0 1px 3px rgba(0,0,0,0.1); flex:1 1 200px; min-width:200px; }
    .card h3 { margin-bottom:8px; }
    .card button { margin-top:8px; padding:6px 12px; border:none; border-radius:4px; cursor:pointer; background:#3498db; color:white; }
    table { width:100%; border-collapse:collapse; }
    th, td { padding:12px; border-bottom:1px solid #ddd; text-align:left; }
    th { background:#ecf0f1; }
    .btn { padding:6px 12px; border:none; border-radius:4px; cursor:pointer; background:#3498db; color:white; margin-right:4px; }
    .btn-danger { background:#e74c3c; }
    .badge-red { background:#e74c3c; color:white; padding:2px 6px; border-radius:8px; font-size:0.8em; }
    .modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.4); justify-content:center; align-items:center; z-index:200; }
    .modal-content { background:#fff; padding:24px; border-radius:8px; width:90%; max-width:500px; position:relative; }
    .modal-content h2 { margin-bottom:16px; }
    .modal-close { position:absolute; top:12px; right:12px; cursor:pointer; font-size:1.2em; }
    input, select { width:100%; padding:8px; margin-bottom:12px; border:1px solid #ccc; border-radius:4px; }
  </style>
</head>
<body>

  <div class="top-bar">
    <div class="school-name">Lincoln High School Admin</div>
    <div class="top-actions">
      <div class="badge" id="crisisCount">0 Crises</div>
      <div class="profile-dropdown">Admin ‚ñº</div>
    </div>
  </div>

  <div class="container">
    <div class="sidebar">
      <a class="active" onclick="showSection('overview')">üè† Overview</a>
      <a onclick="showSection('counselors')">üë©‚Äçüè´ Counselors</a>
      <a onclick="showSection('students')">üë®‚Äçüéì Students</a>
      <a onclick="showSection('assignments')">üîÅ Assignments</a>
      <a onclick="showSection('crisis')">üö® Crisis Monitor</a>
      <a onclick="showSection('audit')">üìú Audit Log</a>
      <a onclick="showSection('settings')">‚öôÔ∏è Settings</a>
    </div>

    <div class="main">
      <div class="section" id="overview">
        <h2>Overview</h2>
        <div class="card-container">
          <div class="card">
            <h3>Total Students</h3>
            <p id="totalStudents">0</p>
          </div>
          <div class="card">
            <h3>Total Counselors</h3>
            <p id="totalCounselors">0</p>
          </div>
          <div class="card">
            <h3>Open Messages</h3>
            <p id="openMessages">0</p>
          </div>
          <div class="card">
            <h3>Active Crises</h3>
            <p id="activeCrises">0</p>
          </div>
        </div>
      </div>

      <div class="section" id="counselors" style="display:none;">
        <h2>Counselors <button class="btn" onclick="openModal('addCounselorModal')">+ Add Counselor</button></h2>
        <div class="card-container" id="counselorCards"></div>
      </div>

      <div class="section" id="students" style="display:none;">
        <h2>Students <button class="btn" onclick="openModal('addStudentModal')">+ Add Student</button></h2>
        <table>
          <thead>
            <tr>
              <th>Name</th>
              <th>Grade</th>
              <th>Counselor</th>
              <th>Crisis</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="studentTable"></tbody>
        </table>
      </div>

      <div class="section" id="assignments" style="display:none;">
        <h2>Assignments</h2>
        <p>Drag & drop interface placeholder (to assign students to counselors)</p>
      </div>

      <div class="section" id="crisis" style="display:none;">
        <h2>Crisis Monitor</h2>
        <div class="card-container" id="crisisCards"></div>
      </div>

      <div class="section" id="audit" style="display:none;">
        <h2>Audit Log</h2>
        <table>
          <thead>
            <tr>
              <th>Time</th>
              <th>User</th>
              <th>Role</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody id="auditTable"></tbody>
        </table>
      </div>

      <div class="section" id="settings" style="display:none;">
        <h2>Settings</h2>
        <p>School info, notification settings, access control...</p>
      </div>
    </div>
  </div>

  <!-- MODALS -->
  <div class="modal" id="addCounselorModal">
    <div class="modal-content">
      <span class="modal-close" onclick="closeModal('addCounselorModal')">&times;</span>
      <h2>Add Counselor</h2>
      <input type="text" placeholder="Counselor Name" id="newCounselorName">
      <input type="email" placeholder="Email" id="newCounselorEmail">
      <button class="btn" onclick="addCounselor()">Add Counselor</button>
    </div>
  </div>

  <div class="modal" id="addStudentModal">
    <div class="modal-content">
      <span class="modal-close" onclick="closeModal('addStudentModal')">&times;</span>
      <h2>Add Student</h2>
      <input type="text" placeholder="Student Name" id="newStudentName">
      <input type="number" placeholder="Grade" id="newStudentGrade">
      <select id="newStudentCounselor"></select>
      <button class="btn" onclick="addStudent()">Add Student</button>
    </div>
  </div>

  <script>
    // Section switching
    function showSection(sectionId){
      document.querySelectorAll('.main .section').forEach(sec => sec.style.display='none');
      document.getElementById(sectionId).style.display='block';
      document.querySelectorAll('.sidebar a').forEach(link => link.classList.remove('active'));
      document.querySelector(`.sidebar a[onclick="showSection('${sectionId}')"]`).classList.add('active');
    }

    // Modals
    function openModal(id){ document.getElementById(id).style.display='flex'; }
    function closeModal(id){ document.getElementById(id).style.display='none'; }

    // Storage keys
    const STORAGE = { counselors: 'adminCounselors', students: 'adminStudents', audit: 'adminAudit' };

    // Load data from localStorage
    function loadData(){
      const counselors = JSON.parse(localStorage.getItem(STORAGE.counselors)||'[]');
      const students = JSON.parse(localStorage.getItem(STORAGE.students)||'[]');
      const messages = JSON.parse(localStorage.getItem('studentMessages')||'[]');

      // Counselors
      const container = document.getElementById('counselorCards');
      container.innerHTML='';
      counselors.forEach(c=>{
        const activeCrises = messages.filter(m=>m.counselor===c.username && m.urgency==='I‚Äôm in Crisis').length;
        const assigned = students.filter(s=>s.counselor===c.username).length;
        const card = document.createElement('div'); card.className='card';
        card.innerHTML=`<h3>${c.name}</h3>
          <p>Assigned Students: ${assigned}</p>
          <p>Active Crises: ${activeCrises}</p>
          <button class="btn" onclick="manageCounselor('${c.username}')">Manage</button>`;
        container.appendChild(card);
      });
      document.getElementById('totalCounselors').innerText = counselors.length;

      // Students
      const tbody = document.getElementById('studentTable');
      tbody.innerHTML='';
      students.forEach(s=>{
        const crisisBadge = messages.find(m=>m.firstName+' '+m.lastName===s.name && m.urgency==='I‚Äôm in Crisis') ? '<span class="badge-red">Red</span>' : '';
        const row = document.createElement('tr');
        row.innerHTML=`<td>${s.name}</td><td>${s.grade}</td><td>${s.counselor}</td><td>${crisisBadge}</td>
          <td>
            <button class="btn" onclick="assignStudent('${s.name}')">Assign</button>
            <button class="btn btn-danger" onclick="archiveStudent('${s.name}')">Archive</button>
          </td>`;
        tbody.appendChild(row);
      });
      document.getElementById('totalStudents').innerText = students.length;
      document.getElementById('activeCrises').innerText = document.querySelectorAll('#studentTable .badge-red').length;

      // Crisis Monitor
      const crisisContainer = document.getElementById('crisisCards');
      crisisContainer.innerHTML='';
      messages.filter(m=>m.urgency==='I‚Äôm in Crisis').forEach(m=>{
        const card = document.createElement('div'); card.className='card';
        card.innerHTML=`<h3>${m.firstName} ${m.lastName} (Grade ${m.grade})</h3>
          <p>Counselor: ${m.counselor}</p>
          <p>Status: Unseen</p>
          <button class="btn" onclick="markReviewed('${m.firstName}','${m.lastName}')">Mark Reviewed</button>
          <button class="btn btn-danger" onclick="escalate('${m.firstName}','${m.lastName}')">Escalate</button>`;
        crisisContainer.appendChild(card);
      });
      document.getElementById('crisisCount').innerText = messages.filter(m=>m.urgency==='I‚Äôm in Crisis').length + ' Crises';

      // Audit Log
      const auditTbody = document.getElementById('auditTable');
      auditTbody.innerHTML='';
      const auditLogs = JSON.parse(localStorage.getItem(STORAGE.audit)||'[]');
      auditLogs.forEach(a=>{
        const row = document.createElement('tr');
        row.innerHTML=`<td>${a.time}</td><td>${a.user}</td><td>${a.role}</td><td>${a.action}</td>`;
        auditTbody.appendChild(row);
      });
    }

    // Add Counselor
    function addCounselor(){
      const name = document.getElementById('newCounselorName').value;
      const email = document.getElementById('newCounselorEmail').value;
      if(!name || !email){ alert('Enter all fields'); return; }
      const username = email.split('@')[0];
      const counselors = JSON.parse(localStorage.getItem(STORAGE.counselors)||'[]');
      counselors.push({name, email, username});
      localStorage.setItem(STORAGE.counselors, JSON.stringify(counselors));
      addAudit('Admin','Admin',`Added counselor ${name}`);
      loadData();
      closeModal('addCounselorModal');
    }

    // Add Student
    function addStudent(){
      const name = document.getElementById('newStudentName').value;
      const grade = document.getElementById('newStudentGrade').value;
      const counselor = document.getElementById('newStudentCounselor').value;
      if(!name || !grade || !counselor){ alert('Enter all fields'); return; }
      const students = JSON.parse(localStorage.getItem(STORAGE.students)||'[]');
      students.push({name, grade, counselor});
      localStorage.setItem(STORAGE.students, JSON.stringify(students));
      addAudit('Admin','Admin',`Added student ${name} to ${counselor}`);
      loadData();
      closeModal('addStudentModal');
    }

    // Audit
    function addAudit(user, role, action){
      const logs = JSON.parse(localStorage.getItem(STORAGE.audit)||'[]');
      logs.push({time:new Date().toLocaleString(), user, role, action});
      localStorage.setItem(STORAGE.audit, JSON.stringify(logs));
    }

    // Assign / Archive / Manage stubs
    function manageCounselor(username){ alert('Manage '+username); }
    function assignStudent(name){ alert('Assign '+name); }
    function archiveStudent(name){ alert('Archive '+name); }
    function markReviewed(first,last){ alert('Reviewed '+first+' '+last); }
    function escalate(first,last){ alert('Escalate '+first+' '+last); }

    // Populate counselor dropdown
    function populateCounselorDropdown(){
      const dropdown = document.getElementById('newStudentCounselor');
      dropdown.innerHTML='';
      const counselors = JSON.parse(localStorage.getItem(STORAGE.counselors)||'[]');
      counselors.forEach(c=>{
        const opt = document.createElement('option'); opt.value = c.name; opt.textContent = c.name;
        dropdown.appendChild(opt);
      });
    }

    // Init
    window.onload = ()=>{
      loadData();
      populateCounselorDropdown();
      setInterval(loadData,5000);
    }
  </script>

</body>
</html>


